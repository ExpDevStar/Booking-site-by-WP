!function(e){function t(e){return e=new Date(e),!isNaN(e.getTime())}function i(t){e(t).find(".datepicker").datepicker({onSelect:function(){}})}function a(){n.on("click",".hb-pricing-controls a",function(t){var a=e(this),n=a.closest(".hb-pricing-table"),o=a.data("action");switch(t.preventDefault(),o){case"clone":var r=!1;e(".hb-pricing-table").length<1&&(r=!0);var s=e(wp.template("hb-pricing-table")({clone:r})),c=s.find(".hb-pricing-price");s.hide().css("background-color","#00A0D2").css("transition","background-color 0.5s"),i(s),n.find(".hb-pricing-price").each(function(e){c.eq(e).val(this.value)}),n.hasClass("regular-price")?(s.removeClass("regular-price"),e(".hb-pricing-table-title > span",s).html("Date Range"),e("#hb-pricing-plan-list").append(s)):s.insertAfter(n),s.fadeTo(350,.8).delay(1e3).fadeTo(250,1,function(){e(this).css("background-color",""),e(".dashicons-edit",this).trigger("click")}),e("#hb-no-plan-message").hide();break;case"edit":a.hasClass("dashicons-edit")?(e("input",n).removeAttr("readonly"),e("input",n).datepicker("enable"),a.removeClass("dashicons-edit").addClass("dashicons-yes"),e(".hb-pricing-table .dashicons-yes").not(a).trigger("click")):(e("input",n).attr("readonly","readonly"),e("input",n).datepicker("disable"),a.removeClass("dashicons-yes").addClass("dashicons-edit"));break;case"remove":confirm(hotel_booking_l18n.confirm_remove_pricing_table)&&(0==n.siblings(".hb-pricing-table").length&&e("#hb-no-plan-message").show(),n.remove())}return!1}),e("#tp_hotel_booking_pricing #hb-room-select").change(function(){var e=window.location.href;e=e.replace(/[&]?hb-room=[0-9]+/,""),0!=this.value&&(e+="&hb-room="+this.value),window.location.href=e}),e('form[name="pricing-table-form"]').submit(function(){var i=!0;return e(".hb-pricing-table").each(function(a){var n=e(this),o=n.find('input[name^="date-start"]'),r=n.find('input[name^="date-end"]');return n.hasClass("regular-price")||(t(o.val())?t(r.val())||(alert(hotel_booking_l18n.empty_pricing_plan_start_date),r.focus(),i=!1):(alert(hotel_booking_l18n.empty_pricing_plan_start_date),o.focus(),i=!1),i)?void n.find('input[type="text"]').each(function(){var t=e(this),i=t.attr("name");i=i.replace(/__INDEX__/,a-1e3),t.attr("name",i)}):!1}),i}),e(".hb-pricing-table").each(function(){i(this)});e(".hb-admin-sub-tab li a").click(function(t){t.preventDefault();var i=e(this).attr("href"),a=e(i),n=e(this).parent();return n.addClass("current").siblings().removeClass("current"),a.show().css("opacity",1).siblings(".hb-sub-tab-content").hide(),history.pushState({},"",window.location.href.replace(/#?.*/,"")+i),!1}).filter('[href*="'+window.location.hash+'"]').trigger("click");e.datepicker.setDefaults({dateFormat:"mm/dd/yy"}),e(".datetime-picker-metabox").datepicker({minDate:0,maxDate:"+365D",numberOfMonths:2,onSelect:function(){var e=jQuery(this).datepicker("getDate");e&&e.setDate(e.getDate()+1)}}),e("#datepickerImage").click(function(){e("#txtFromDate").datepicker("show")}),e(".hb-add-new-plan").click(function(){if(!(e(".hb-pricing-table").length>=2)){var t=e(wp.template("hb-pricing-table")({}));e("#hb-pricing-plan-list").prepend(t),i(t),t.css("opacity",0).css("background-color","#00A0D2").css("transition","background-color 0.5s"),e(window).scrollTop()>t.offset().top-100&&e(window).scrollTop(t.offset().top-100),t.fadeTo(350,.8).delay(1e3).fadeTo(250,1,function(){e(this).css("background-color",""),e('a[data-action="edit"]',t).trigger("click")}),e("#hb-no-plan-message").hide()}}),e("#hb-booking-date-from").datepicker({onSelect:function(){var t=jQuery(this).datepicker("getDate");e("#hb-booking-date-to").datepicker("option","minDate",t)}}),e("#hb-booking-date-to").datepicker({onSelect:function(){var t=jQuery(this).datepicker("getDate");e("#hb-booking-date-from").datepicker("option","maxDate",t)}}),e("form#posts-filter").submit(function(){var t=0;return e('#hb-booking-date-from, #hb-booking-date-to, select[name="filter-type"]').each(function(){e(this).val()&&t++}),t>0&&3>t?(alert(hotel_booking_l18n.filter_error),!1):void 0}),e("#gallery_settings").on("click",".attachment.add-new",function(t){t.preventDefault();var i=wp.media.frames.file_frame=wp.media({multiple:!0}),a=e(this);i.on("select",function(){for(var e=i.state().get("selection").toJSON(),t="",n=0;n<e.length;n++){{var o=e[n];o.url.replace(hotel_settings.upload_base_url,"")}t+='<li class="attachment">',t+='<div class="attachment-preview">',t+='<div class="thumbnail">',t+='<div class="centered">',t+='<img src="'+o.url+'"/>',t+='<input type="hidden" name="_hb_gallery[]" value="'+o.id+'" />',t+="</div>",t+="</div>",t+="</div>",t+='<a class="dashicons dashicons-trash" title="Remove this image"></a>',t+="</li>"}a.before(t)}),i.open()}).on("click",".attachment .dashicons-trash",function(t){t.preventDefault(),e(this).parent().remove()}),e('form[name="hb-admin-settings-form"] select').select2(),e('input[name="tp_hotel_booking_email_new_booking_enable"]').on("change _change",function(){var t=e(this).closest("tr").siblings("."+e(this).attr("name"));this.checked?t.show():t.hide()}).trigger("change"),e("#gallery_settings ul").sortable(),e(".tp_hotel_booking_tabs_settings li a:first").addClass("active"),e(".tp_hotel_booking_setting_fields:first").addClass("active"),e(document).on("click",".tp_hotel_booking_tabs_settings li a",function(t){t.preventDefault();var i=e(this),a=i.attr("href"),n=e(a);"undefined"!=typeof a&&(e(".tp_hotel_booking_setting_fields").removeClass("active"),e(".tp_hotel_booking_tabs_settings li a").removeClass("active"),i.addClass("active"),1===n.length&&n.addClass("active"))})}var n=e(document);void 0==Date.prototype.compareWith&&(Date.prototype.compareWith=function(e){"string"==typeof e&&(e=new Date(e));var t=parseInt(this.getTime()/1e3),i=parseInt(e.getTime()/1e3);return t>i?1:i>t?-1:0}),n.ready(a)}(jQuery);