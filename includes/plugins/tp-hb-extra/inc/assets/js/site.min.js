!function(t){TPHB_Extra_Site={init:function(){this.toggle_extra(),this.removePackage()},parseJSON:function(a){if(!t.isPlainObject(a)){var e=a.match(/<!-- HB_AJAX_START -->(.*)<!-- HB_AJAX_END -->/);try{a=t.parseJSON(e?e[1]:a)}catch(n){console.log(n),a={}}}return a},toggle_extra:function(){t(document).on("change",".number_room_select",function(a){a.preventDefault();var e=t(this),n=e.parents(".hb-search-room-results"),i=n.find(".hb_addition_package_extra"),o=i.find(".hb_addition_packages"),r=e.val();""!==r?(n.parent().siblings().find(".hb_addition_packages").removeClass("active").slideUp(),o.removeAttr("style").addClass("active"),i.removeAttr("style").slideDown()):(i.slideUp(),r=1),n.find(".hb_optional_quantity").val(r)}),t(document).on("click",".hb_package_toggle",function(a){a.preventDefault();var e=t(this),n=e.parents(".hb_addition_package_extra");toggle=n.find(".hb_addition_packages"),e.toggleClass("active"),toggle.toggleClass("active"),TPHB_Extra_Site.optional_toggle(toggle)})},optional_toggle:function(t){t.hasClass("active")?t.slideDown():t.slideUp()},toggleCheckbox:function(){t(document).on("change",".hb_optional_quantity_selected",function(a){a.preventDefault();var e=t(this),n=e.parents("li:first"),i=n.find(".hb_optional_quantity");e.is(":checked")?i.attr("readonly",!0):i.hasClass("tp_hb_readonly")||i.removeAttr("readonly")})},removePackage:function(){t(document).on("click",".hb_package_remove",function(a){a.preventDefault();var e=t(this),n=e.attr("data-package"),i=e.parents(".hb_mini_cart_item:first");("undefined"==typeof i||0===i.length)&&(i=e.parents(".hb_checkout_item.package:first"));var o=i.attr("data-id");"undefined"==typeof o&&(o=i.attr("data-room-id"));var r=i.attr("data-search-key");"undefined"==typeof r&&(r=i.attr("data-time-key")),t.ajax({url:hotel_settings.ajax,method:"POST",data:{action:"tp_hotel_booking_remove_package",room_id:o,package_id:n,time_key:r},dataType:"html",beforeSend:function(){}}).done(function(a){a=TPHB_Extra_Site.parseJSON(a),"undefined"!=typeof a.status&&"success"==a.status&&HB_Booking_Cart.hb_add_to_cart_callback(a,function(){for(var e=t("#hotel-booking-payment, #hotel-booking-cart"),n=0;n<e.length;n++){for(var i=t(e[n]),o=i.find("table").find(".hb_checkout_item.package"),r=0;r<o.length;r++){var d=t(o[r]),_=d.attr("data-time-key"),c=d.attr("data-package-id"),s=d.attr("data-room-id");if(_===a.search_key&&s===a.id&&c==a.package_id){var l=t('tr.hb_checkout_item.package[data-time-key="'+_+'"][data-room-id="'+s+'"]'),f=t('tr.hb_addition_services_title[data-room-id="'+s+'"][data-time-key="'+_+'"]'),p=t('.hb_checkout_item:not(.package)[data-date="'+_+'"][data-id="'+s+'"]'),g=l.length;if(1===g)d.remove(),f.remove(),p.find("td:first").removeAttr("rowspan");else{var h=p.find("td:first").attr("rowspan");d.remove(),p.find("td:first").attr("rowspan",h-1)}break}}"undefined"!=typeof a.sub_total&&i.find("span.hb_sub_total_value").html(a.sub_total),"undefined"!=typeof a.grand_total&&i.find("span.hb_grand_total_value").html(a.grand_total),"undefined"!=typeof a.advance_payment&&i.find("span.hb_advance_payment_value").html(a.advance_payment)}})})})}},t(document).ready(function(){TPHB_Extra_Site.init()})}(jQuery);