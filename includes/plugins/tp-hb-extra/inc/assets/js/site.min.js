!function(t){TPHB_Extra_Site={init:function(){this.toggle_extra(),this.removePackage()},parseJSON:function(a){if(!t.isPlainObject(a)){var e=a.match(/<!-- HB_AJAX_START -->(.*)<!-- HB_AJAX_END -->/);try{a=t.parseJSON(e?e[1]:a)}catch(n){console.log(n),a={}}}return a},toggle_extra:function(){t(document).on("change",".number_room_select",function(a){a.preventDefault();var e=t(this),n=e.parents(".hb-search-room-results"),i=n.find(".hb_addition_package_extra"),o=i.find(".hb_addition_packages"),r=e.val();""!==r?(n.parent().siblings().find(".hb_addition_packages").removeClass("active").slideUp(),o.removeAttr("style").addClass("active"),i.removeAttr("style").slideDown()):(i.slideUp(),r=1),n.find(".hb_optional_quantity").val(r)}),t(document).on("click",".hb_package_toggle",function(a){a.preventDefault();var e=t(this),n=e.parents(".hb_addition_package_extra");toggle=n.find(".hb_addition_packages"),e.toggleClass("active"),toggle.toggleClass("active"),TPHB_Extra_Site.optional_toggle(toggle)})},optional_toggle:function(t){t.hasClass("active")?t.slideDown():t.slideUp()},toggleCheckbox:function(){t(document).on("change",".hb_optional_quantity_selected",function(a){a.preventDefault();var e=t(this),n=e.parents("li:first"),i=n.find(".hb_optional_quantity");e.is(":checked")?i.attr("readonly",!0):i.hasClass("tp_hb_readonly")||i.removeAttr("readonly")})},removePackage:function(){t(document).on("click",".hb_package_remove",function(a){a.preventDefault();var e=t(this),n=e.attr("data-cart-id"),i=e.parents(".hb_mini_cart_item:first"),o=e.parents(".hb_mini_cart_item:first, tr");("undefined"==typeof i||0===i.length)&&(i=e.parents(".hb_checkout_item.package:first")),t.ajax({url:hotel_settings.ajax,method:"POST",data:{action:"tp_hotel_booking_remove_package",cart_id:n},dataType:"html",beforeSend:function(){o.hb_overlay_ajax_start()}}).done(function(a){a=TPHB_Extra_Site.parseJSON(a),"undefined"!=typeof a.status&&"success"==a.status&&HB_Booking_Cart.hb_add_to_cart_callback(a,function(){for(var e=t("#hotel-booking-payment, #hotel-booking-cart"),n=0;n<e.length;n++){for(var i=t(e[n]),o=i.find("table").find(".hb_checkout_item.package"),r=0;r<o.length;r++){var _=t(o[r]),d=_.attr("data-cart-id"),c=_.attr("data-parent-id");if(d===a.package_id&&c==a.cart_id){var s=(t('tr.hb_checkout_item.package[data-cart-id="'+d+'"][data-parent-id="'+c+'"]'),t('tr.hb_addition_services_title[data-cart-id="'+c+'"]')),l=t('.hb_checkout_item:not(.package)[data-cart-id="'+c+'"]'),h=t('tr.hb_checkout_item.package[data-parent-id="'+c+'"]').length;if(1===h)_.remove(),s.remove(),l.find("td:first").removeAttr("rowspan");else{var p=l.find("td:first").attr("rowspan");_.remove(),l.find("td:first").attr("rowspan",p-1)}break}}"undefined"!=typeof a.sub_total&&i.find("span.hb_sub_total_value").html(a.sub_total),"undefined"!=typeof a.grand_total&&i.find("span.hb_grand_total_value").html(a.grand_total),"undefined"!=typeof a.advance_payment&&i.find("span.hb_advance_payment_value").html(a.advance_payment)}}),o.hb_overlay_ajax_stop()})})}},t(document).ready(function(){TPHB_Extra_Site.init()})}(jQuery);